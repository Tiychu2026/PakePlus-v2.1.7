{"name":"edddcbbbfabaef","url":"https://403ol.com","showName":"403OL","appid":"com.app403ol.echocms","icon":"","iconPath":"","iconRound":true,"state":true,"single":true,"injectJq":true,"tauriApi":false,"devbug":false,"version":"0.0.1","preview":"desktop","platform":["1-1","2-2"],"width":600,"height":801,"desc":"","jsFile":[],"filterCss":"","customJs":"// very important, if you don't know what it is, don't touch it\n// 非常重要，不懂代码不要动，这里可以解决80%的问题，也可以生产1000+的bug\nconst hookClick = (e) => {\n    const origin = e.target.closest('a')\n    const isBaseTargetBlank = document.querySelector(\n        'head base[target=\"_blank\"]'\n    )\n    console.log('origin', origin, isBaseTargetBlank)\n\n    // ===== 新增：ArtPlayer 弹窗播放逻辑 - 匹配 .m3u8 链接 =====\n    const isM3u8Link = origin && origin.href && origin.href.endsWith('.m3u8');\n    if (isM3u8Link && window.TAURI) {\n        e.preventDefault()\n        e.stopPropagation()\n        console.log('检测到m3u8链接，打开弹窗播放器：', origin.href)\n        openPopupPlayer(origin.href) // 弹窗播放（替换原独立窗口）\n        return\n    }\n    // ===== 弹窗播放逻辑结束 =====\n\n    // 原有判断逻辑：非m3u8链接，按原需求处理\n    if (\n        (origin && origin.href && origin.target === '_blank') ||\n        (origin && origin.href && isBaseTargetBlank)\n    ) {\n        e.preventDefault()\n        console.log('handle origin', origin)\n        location.href = origin.href\n    } else {\n        console.log('not handle origin', origin)\n    }\n}\n\n// ===== 新增：页面内弹窗 ArtPlayer 播放器（核心功能）=====\nfunction openPopupPlayer(m3u8Url) {\n    // 1. 检查是否已存在弹窗，避免重复创建\n    let popup = document.getElementById('artplayer-popup');\n    if (popup) {\n        // 已存在弹窗，更新播放链接并显示\n        updatePopupPlayer(m3u8Url);\n        return;\n    }\n\n    // 2. 创建弹窗容器（全屏半透明遮罩+居中播放器）\n    popup = document.createElement('div');\n    popup.id = 'artplayer-popup';\n    popup.style.cssText = `\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100vw;\n        height: 100vh;\n        background: rgba(0, 0, 0, 0.9);\n        z-index: 999999; // 确保在所有元素之上\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        padding: 20px;\n        box-sizing: border-box;\n    `;\n\n    // 3. 创建播放器容器（自适应大小，最大宽高限制）\n    const playerContainer = document.createElement('div');\n    playerContainer.id = 'artplayer-container';\n    playerContainer.style.cssText = `\n        width: 100%;\n        max-width: 1400px; // 播放器最大宽度\n        height: 100%;\n        max-height: 800px; // 播放器最大高度\n        position: relative;\n    `;\n\n    // 4. 创建关闭按钮（右上角）\n    const closeBtn = document.createElement('button');\n    closeBtn.innerText = '×';\n    closeBtn.style.cssText = `\n        position: absolute;\n        top: -40px;\n        right: 0;\n        background: transparent;\n        color: #fff;\n        border: none;\n        font-size: 32px;\n        cursor: pointer;\n        padding: 5px 15px;\n        z-index: 10;\n    `;\n    // 关闭按钮点击事件\n    closeBtn.onclick = () => {\n        popup.remove(); // 移除弹窗\n        if (window.artPopupPlayer) {\n            window.artPopupPlayer.destroy(); // 销毁播放器实例\n            window.artPopupPlayer = null;\n        }\n    };\n\n    // 5. 组装弹窗结构\n    playerContainer.appendChild(closeBtn);\n    popup.appendChild(playerContainer);\n    document.body.appendChild(popup);\n\n    // 6. 初始化 ArtPlayer（关键：指定 type 为 m3u8）\n    window.artPopupPlayer = new Artplayer({\n        container: playerContainer,\n        url: m3u8Url,\n        type: 'm3u8', // 明确文件类型，避免识别失败\n        autoplay: true, // 自动播放\n        controls: true,\n        fullscreen: true,\n        fullscreenWeb: true, // 支持网页全屏\n        volume: 0.7,\n        playbackRate: [0.5, 0.75, 1, 1.25, 1.5, 2], // 倍速选项\n        // 适配弹窗样式\n        style: {\n            width: '100%',\n            height: '100%',\n        },\n    });\n\n    // 7. 点击遮罩空白处关闭弹窗\n    popup.addEventListener('click', (e) => {\n        if (e.target === popup) closeBtn.click();\n    });\n\n    // 8. 监听播放器错误（如链接失效）\n    window.artPopupPlayer.on('error', async (error) => {\n        console.error('播放器错误：', error);\n        await window.TAURI.dialog.message(`播放失败：${error.message}`, {\n            title: '播放错误',\n            type: 'error'\n        });\n        closeBtn.click();\n    });\n}\n\n// ===== 辅助函数：更新已有弹窗的播放链接 =====\nfunction updatePopupPlayer(newM3u8Url) {\n    if (window.artPopupPlayer) {\n        window.artPopupPlayer.src = {\n            url: newM3u8Url,\n            type: 'm3u8'\n        };\n        window.artPopupPlayer.play(); // 自动播放新链接\n    }\n    // 显示弹窗（若之前被隐藏）\n    const popup = document.getElementById('artplayer-popup');\n    if (popup) popup.style.display = 'flex';\n}\n\n// 原有：重写window.open，适配弹窗播放\nwindow.open = function (url, target, features) {\n    console.log('open', url, target, features)\n    if (url && url.endsWith('.m3u8') && window.TAURI) {\n        openPopupPlayer(url); // 脚本调用也走弹窗播放\n        return;\n    }\n    // 原有逻辑：非m3u8链接，当前页面跳转\n    location.href = url;\n}\n\n// 原有：全局点击事件监听\ndocument.addEventListener('click', hookClick, { capture: true });","isHtml":false,"htmlPath":"","htmlFiles":[],"prefix":"","pcRepo":"PakePlus-v2.1.7","iosRepo":"PakePlus-iOS-v2.1.7","androidRepo":"PakePlus-Android-v2.1.7","more":{"windows":{"label":"","title":"403OL","url":"https://403ol.com","userAgent":"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36","width":1920,"height":1080,"theme":null,"resizable":true,"fullscreen":false,"maximized":false,"minWidth":400,"minHeight":300,"maxWidth":1920,"maxHeight":1080,"decorations":true,"transparent":false,"titleBarStyle":"Visible","visible":true,"focus":true,"closable":true,"minimizable":true,"maximizable":true,"alwaysOnTop":false,"alwaysOnBottom":false,"center":false,"shadow":true,"skipTaskbar":false,"tabbingIdentifier":null,"parent":null,"dragDropEnabled":true,"browserExtensionsEnabled":false,"devtools":true,"contentProtected":false,"hiddenTitle":false,"incognito":false,"proxyUrl":null,"useHttpsScheme":false,"zoomHotkeysEnabled":false,"acceptFirstMouse":false,"create":false,"backgroundColor":null,"backgroundThrottling":null,"javascriptDisabled":false}},"phone":{"fullScreen":false,"safeArea":{"top":0,"bottom":0,"left":0,"right":0},"header":{"show":false,"title":"","backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","loading":false,"toolBar":false,"toolBarBackgroundColor":"","toolBarColor":"","toolBarFontSize":16,"toolBarFontWeight":"bold"},"siderMenu":{"show":false,"width":0,"backgroundColor":"","color":"","fontSize":16,"fontWeight":"bold","title":"","titleColor":"","titleFontSize":16,"titleFontWeight":"bold"},"tabBar":{"show":false,"backgroundColor":"","color":"","activeColor":"","fontSize":16,"fontWeight":"bold","tabBarItem":[]},"webview":{"userAgent":"","javaScriptEnabled":true,"domStorageEnabled":true,"allowFileAccess":true,"loadWithOverviewMode":true,"setSupportZoom":true,"clearCache":true}},"ios":{"name":"edddcbbbfabaef","showName":"403OL","version":"0.0.1","webUrl":"https://403ol.com","id":"com.app403ol.echocms.ios","icon":"./app-icon.png","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false,"safeArea":"all"},"android":{"name":"edddcbbbfabaef","showName":"403OL","version":"0.0.1","webUrl":"https://403ol.com","id":"com.app403ol.echocms.android","icon":"./app-icon.png","input":"./app-icon.png","output":"./res","rounded":true,"copyTo":"./app/src/main/res","androidResDir":"./app/src/main/res","desc":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","pubBody":"Package for personal use only, please do not use for commercial purposes（打包仅限个人使用，请勿传播或商业用途）","isHtml":false,"debug":false,"safeArea":"all"},"desktop":{"name":"edddcbbbfabaef","showName":"403OL","version":"0.0.1","id":"com.app403ol.echocms.desktop","desc":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","webUrl":"https://403ol.com","iconPath":"../app-icon.png","inputPath":"../app-icon.png","tempPath":"./processed-image.png","icnsPath":"../src-tauri/icons/icon.icns","pubBody":"打包仅限个人使用，请勿传播或商业用途，否则后果自负","isHtml":false,"single":true,"state":true,"injectJq":false,"tauriApi":true,"buildMethod":"cloud","debug":true}}